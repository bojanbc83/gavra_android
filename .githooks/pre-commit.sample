#!/bin/sh
# Simple pre-commit hook to prevent committing supabase service role key string (example)
# Install: cp .githooks/pre-commit.sample .git/hooks/pre-commit && chmod +x .git/hooks/pre-commit

if git diff --cached --name-only | grep -E '\.(dart|yaml|json|ts|js|md)$' >/dev/null; then
  if git diff --cached | grep -E "eyJhbGciOiJIUz" >/dev/null; then
    echo "\n[ERROR] Potential JWT-like secret found in staged changes. Remove it and use env var or secret instead.\n"
    exit 1
  fi
fi

exit 0
